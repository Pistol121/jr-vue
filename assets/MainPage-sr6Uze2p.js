import{c as I,d as ot,r as y,a as N,h as H,m as nt,T as at,u as l,o as O,b as lt,t as g,_ as U,e as A,f as j,g as s,i as n,j as t,w as F,v as D,F as _,k as x,n as B,l as k,I as ct,p as Y,q as W,s as G,x as R,y as S,z as w,A as it,B as M,C as q,D as dt,E as rt,G as ut,H as ht,J as vt,K as pt}from"./index-nABTJyGq.js";var K=I("alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]),_t=I("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),mt=I("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),yt=I("chevron-up","IconChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),bt=I("git-pull-request","IconGitPullRequest",[["path",{d:"M6 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M6 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M18 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M6 8l0 8",key:"svg-3"}],["path",{d:"M11 6h5a2 2 0 0 1 2 2v8",key:"svg-4"}],["path",{d:"M14 9l-3 -3l3 -3",key:"svg-5"}]]),P=I("line-dashed","IconLineDashed",[["path",{d:"M5 12h2",key:"svg-0"}],["path",{d:"M17 12h2",key:"svg-1"}],["path",{d:"M11 12h2",key:"svg-2"}]]),gt=I("lock-check","IconLockCheck",[["path",{d:"M11.5 21h-4.5a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v.5",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-3"}]]),kt=I("lock-minus","IconLockMinus",[["path",{d:"M12.5 21h-5.5a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}],["path",{d:"M16 19h6",key:"svg-3"}]]),Z=I("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),tt=I("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),ft=I("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]),$t=I("search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]),wt=I("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function X(e){return{height:e.style.height,width:e.style.width,position:e.style.position,visibility:e.style.visibility,overflow:e.style.overflow,paddingTop:e.style.paddingTop,paddingBottom:e.style.paddingBottom,borderTopWidth:e.style.borderTopWidth,borderBottomWidth:e.style.borderBottomWidth,marginTop:e.style.marginTop,marginBottom:e.style.marginBottom}}function Ct(e,o,i){const c=l(e),{width:d}=getComputedStyle(o);o.style.width=d,o.style.position="absolute",o.style.visibility="hidden",o.style.height="";const{height:p}=getComputedStyle(o);return o.style.width=i.width,o.style.position=i.position,o.style.visibility=i.visibility,o.style.height=c,o.style.overflow="hidden",i.height&&i.height!=c?i.height:p}function J(e,o,i,c,d){const p=e.animate(c,d);e.style.height=o.height,p.onfinish=()=>{e.style.overflow=o.overflow,i()}}function Q(e,o,i,c){const d=l(o);return[{height:d,opacity:e.opacityClosed,paddingTop:d,paddingBottom:d,borderTopWidth:d,borderBottomWidth:d,marginTop:d,marginBottom:d},{height:i,opacity:e.opacityOpen,paddingTop:c.paddingTop||0,paddingBottom:c.paddingBottom||0,borderTopWidth:c.borderTopWidth||0,borderBottomWidth:c.borderBottomWidth||0,marginTop:c.marginTop||0,marginBottom:c.marginBottom||0}]}const et=ot({props:{modelValue:{type:Boolean,default:!1},duration:{type:Number,default:500},timingFunction:{type:String,default:"ease-in-out"},timingFunctionEnter:{type:String,default:null},timingFunctionLeave:{type:String,default:null},opacityOpen:{type:Number,default:1},opacityClosed:{type:Number,default:0},tag:{type:String,default:"div"}},emits:["update:modelValue","open-start","open-end","close-start","close-end"],setup(e,{slots:o,attrs:i,emit:c}){const d=y("0px"),p=N(()=>e.timingFunctionEnter||e.timingFunction),u=N(()=>e.timingFunctionLeave||e.timingFunction);function h(v,a){const r=v,C=X(r),T=Ct(d,r,C),V=Q(e,d,T,C),f={duration:e.duration,easing:p.value};J(r,C,()=>{a(),c("open-end")},V,f)}function m(v,a){const r=v,C=X(r),{height:T}=getComputedStyle(r);r.style.height=T,r.style.overflow="hidden";const V=Q(e,d,T,C).reverse(),f={duration:e.duration,easing:u.value};J(r,C,()=>{a(),c("close-end")},V,f)}return()=>H(at,{css:!1,onBeforeEnter:()=>c("open-start"),onEnter:h,onBeforeLeave:()=>c("close-start"),onLeave:m},{default:()=>e.modelValue?H(e.tag,nt(i,{class:"slide-up-down__container"}),o):null})}}),xt={__name:"MyCountUp",props:{start:{type:Number,required:!0}},setup(e){const o=e,i=y(Date.now()),c=y(null),d=()=>{i.value=i.value+1e3},p=N(()=>{if(o.start==0)return"—";let u=Math.round((i.value-o.start)/1e3),h={days:Math.floor(u/(3600*24)),hours:Math.floor(u%(3600*24)/3600),minutes:Math.floor(u%3600/60),seconds:Math.floor(u%60)};return(h.days>0?`${h.days} д `:"")+(h.hours<10?`0${h.hours}`:`${h.hours}`)+(h.minutes<10?`:0${h.minutes}`:`:${h.minutes}`)+(h.seconds<10?`:0${h.seconds}`:`:${h.seconds}`)});return O(()=>{c.value=setInterval(d,1e3)}),lt(()=>{clearInterval(c.value)}),(u,h)=>g(p.value)}},st=e=>(G("data-v-1790dfae"),e=e(),R(),e),It={class:"row"},St={class:"col-auto"},Mt=["value"],Ft={class:"col"},Bt={class:"col-auto"},Lt={key:1,class:"tag border-success-subtle gap-1 px-2 h-100"},Tt={key:1,class:"spinner-border spinner-border-sm"},Vt={class:"col-12"},Ot={class:"form-floating mt-2"},Pt=st(()=>t("option",{value:"",selected:""},"Не выбран",-1)),Ut=["value"],jt=st(()=>t("label",{for:"celectCert"},"Сертификат",-1)),Gt=["list"],Rt=["id"],qt=["value"],Nt={__name:"startScenario",props:{scenario:{type:Object,required:!0,default:()=>{}}},emits:["loading","addInstance"],setup(e,{emit:o}){const i=e,c=o,d=A(),p=j(),u=y(p.selectedGenerator),h=y(""),m=y(""),v=y(!1),a=y(!1),r=async V=>{c("loading",!0);let f=await p.runInstance({entityId:i.scenario.id,generatorId:u.value,args:h.value,certId:m.value},V);c("loading",!1),f===!0&&c("addInstance",!1)},C=async()=>{a.value=!0,await d.unsetCertificate(i.scenario.id),a.value=!1};function T(){return v.value=!v.value,v.value}return(V,f)=>(s(),n("div",It,[t("div",St,[F(t("select",{class:"form-select","onUpdate:modelValue":f[0]||(f[0]=b=>u.value=b)},[(s(!0),n(_,null,x(l(p).generators,b=>(s(),n("option",{key:b.generatorId,value:b.generatorId},g(b.ip),9,Mt))),128))],512),[[D,u.value]])]),t("div",Ft,[t("button",{class:"btn btn-outline-success me-2",onClick:f[1]||(f[1]=b=>r())}," Start "),t("button",{class:"btn btn-outline-warning",onClick:f[2]||(f[2]=b=>r("force"))}," Force start ")]),t("div",Bt,[e.scenario.cert?(s(),n("span",Lt,[k(l(Z),{class:"icon icon-tabler text-success cursor-pointer",size:8,"data-bs-toggle":"tooltip","data-bs-html":"true","data-bs-original-title":`Привязан сертификат<br><strong>${e.scenario.cert}</strong>`},null,8,["data-bs-original-title"]),a.value?(s(),n("span",Tt)):(s(),n("span",{key:0,class:"btn-close cursor-pointer",onClick:C}))])):(s(),n("button",{key:0,class:B(["btn btn-icon",[v.value?"btn-info":"btn-outline-info"]]),onClick:T},[k(l(ct),{class:"icon icon-tabler"})],2))]),t("div",Vt,[k(l(et),{modelValue:v.value,"onUpdate:modelValue":f[4]||(f[4]=b=>v.value=b)},{default:Y(()=>[t("div",Ot,[F(t("select",{class:"form-select",id:"celectCert","aria-label":"Secect .jmx certificate","onUpdate:modelValue":f[3]||(f[3]=b=>m.value=b)},[Pt,(s(!0),n(_,null,x(l(d).certs,b=>(s(),n("option",{key:b.id,value:b.id},g(b.path)+g(b.name),9,Ut))),128))],512),[[D,m.value]]),jt])]),_:1},8,["modelValue"]),F(t("input",{type:"text","onUpdate:modelValue":f[5]||(f[5]=b=>h.value=b),class:"form-control mt-2 w-100 fs-5",spellcheck:"false",list:e.scenario.project+"/"+e.scenario.scenarioName},null,8,Gt),[[W,h.value]]),t("datalist",{id:e.scenario.project+"/"+e.scenario.scenarioName},[(s(!0),n(_,null,x(e.scenario.args,b=>(s(),n("option",{value:b,key:b},null,8,qt))),128))],8,Rt)])]))}},At=U(Nt,[["__scopeId","data-v-1790dfae"]]),Dt={class:"row"},Wt={class:"col-auto"},Et=["value"],zt={class:"col-auto"},Ht={class:"col-12"},Kt=["list"],Xt=["id"],Jt=["value"],Qt={__name:"startInstance",props:{scenario:{type:Object,required:!0,default:()=>{}}},emits:["loading"],setup(e,{emit:o}){const i=e,c=o,d=j(),p=y(d.selectedGenerator),u=y(""),h=async m=>{c("loading",!0),await d.runInstance({entityId:i.scenario.id,generatorId:p.value,args:u.value},m),c("loading",!1)};return(m,v)=>(s(),n("div",Dt,[t("div",Wt,[F(t("select",{id:"ipAddress",class:"form-select","onUpdate:modelValue":v[0]||(v[0]=a=>p.value=a)},[(s(!0),n(_,null,x(l(d).generators,a=>(s(),n("option",{key:a.generatorId,value:a.generatorId},g(a.ip),9,Et))),128))],512),[[D,p.value]])]),t("div",zt,[t("button",{class:"btn btn-outline-success me-2",onClick:v[1]||(v[1]=a=>h())}," Start "),t("button",{class:"btn btn-outline-warning",onClick:v[2]||(v[2]=a=>h("force"))}," Force start ")]),t("div",Ht,[F(t("input",{type:"text","onUpdate:modelValue":v[3]||(v[3]=a=>u.value=a),class:"form-control mt-2 w-100 fs-5",spellcheck:"false",list:e.scenario.project+"/"+e.scenario.scenarioName},null,8,Kt),[[W,u.value]]),t("datalist",{id:e.scenario.project+"/"+e.scenario.scenarioName},[(s(!0),n(_,null,x(e.scenario.args,a=>(s(),n("option",{value:a,key:a},null,8,Jt))),128))],8,Xt)])]))}},Yt={class:"word_break"},Zt={class:"word_break"},te={class:"text-center"},ee={key:0,class:"status status-green"},se={key:1,class:"status status-red"},oe={class:"text-center"},ne={class:"row"},ae={class:"col"},le={class:"row row-cols-auto g-2"},ce={class:"col"},ie={key:0,class:"col"},de=["data-bs-original-title"],re={class:"col-auto"},ue={key:0,class:"form-fieldset my-3"},he={key:1},ve={class:"text-muted d-block mt-2"},pe={class:"text-muted d-block mt-2"},_e={key:2,class:"text-center mt-3 mb-1"},me={class:"row"},ye={class:"col-auto"},be=["onClick"],ge={class:"col-auto text-muted mt-auto mb-auto"},ke={class:"text-muted d-block mt-2"},fe={__name:"MyScenario",props:{scenario:Object},setup(e){const o=j(),i=y(!1),c=y(!1),d=y(!1);function p(){return i.value=!i.value,i.value}function u(){return c.value=!c.value,c.value}const h=async v=>{d.value=!0,await o.stopScenarios(v),d.value=!1},m=async(v,a)=>{d.value=!0,await o.stopInstance(v,a),d.value=!1};return(v,a)=>(s(),n("tr",null,[t("td",Yt,g(e.scenario.project),1),t("td",Zt,g(e.scenario.scenarioName),1),t("td",te,[e.scenario.running===!0?(s(),n("span",ee," Online ")):(s(),n("span",se,"Offline"))]),t("td",oe,[e.scenario.running?(s(),S(xt,{key:0,start:e.scenario.instances[0].timestamp},null,8,["start"])):(s(),n(_,{key:1},[w("—")],64))]),t("td",{class:B({loading:d.value})},[F(k(At,{scenario:e.scenario,onLoading:a[0]||(a[0]=r=>d.value=r)},null,8,["scenario"]),[[it,e.scenario.running===!1]]),e.scenario.running===!0?(s(),n(_,{key:0},[t("div",ne,[t("div",ae,[t("div",le,[t("div",ce,[e.scenario.instances.length==1?(s(),n("button",{key:0,class:"btn btn-outline-danger btn-sm px-3",onClick:a[1]||(a[1]=r=>h(e.scenario.id))}," Stop ")):(s(),n("button",{key:1,class:"btn btn-outline-danger btn-sm px-3",onClick:a[2]||(a[2]=r=>h(e.scenario.id))}," Stop all "))]),e.scenario.cert?(s(),n("div",ie,[t("span",{class:"tag border-success-subtle px-1","data-bs-toggle":"tooltip","data-bs-html":"true","data-bs-original-title":`Запущено с сертификатом<br><strong>${e.scenario.cert}</strong>`},[k(l(Z),{class:"icon icon-tabler text-success",size:7})],8,de)])):M("",!0)])]),t("div",re,[t("button",{class:B(["btn btn-sm px-2",[c.value?"btn-info":"btn-outline-info"]]),onClick:u},[k(l(tt),{class:"icon icon-tabler"}),w(" Instance ")],2)])]),c.value?(s(),n("fieldset",ue,[k(Qt,{scenario:e.scenario,onLoading:a[3]||(a[3]=r=>d.value=r),onAddInstance:a[4]||(a[4]=r=>c.value=!1)},null,8,["scenario"])])):M("",!0),e.scenario.instances.length==1?(s(),n("span",he,[t("small",ve,g(e.scenario.instances[0].ipAddress),1),t("small",pe,g(e.scenario.instances[0].args),1)])):(s(),n("div",_e,[t("div",{class:"link-secondary cursor-pointer",onClick:p},[i.value&&e.scenario.instances.length>1?(s(),n(_,{key:0},[w(" Hide instances "),k(l(yt),{class:"icon icon-tabler"})],64)):(s(),n(_,{key:1},[w(" Show "+g(e.scenario.instances.length)+" instances ",1),k(l(mt),{class:"icon icon-tabler"})],64))])])),e.scenario.instances.length>1?(s(),S(l(et),{key:3,modelValue:i.value,"onUpdate:modelValue":a[5]||(a[5]=r=>i.value=r)},{default:Y(()=>[(s(!0),n(_,null,x(e.scenario.instances,r=>(s(),n("div",{key:r.id,class:"instance my-3"},[t("div",me,[t("div",ye,[t("button",{class:"btn btn-outline-danger btn-sm px-3",onClick:C=>m(e.scenario.id,r.id)}," Stop ",8,be)]),t("div",ge,[t("small",null,g(r.ipAddress),1)])]),t("small",ke,g(r.args),1)]))),128))]),_:1},8,["modelValue"])):M("",!0)],64)):M("",!0)],2)]))}},E=e=>(G("data-v-1ceadcb3"),e=e(),R(),e),$e={class:"card mb-3"},we={class:"card-header"},Ce=E(()=>t("h5",{class:"card-title"},"Выбрать проект(ы)",-1)),xe={class:"card-actions"},Ie={class:"input-icon"},Se={class:"input-icon-addon"},Me=["value"],Fe={class:"card-body"},Be={class:"ps-1 pt-1",id:"scenarios"},Le={id:"filterForm"},Te={key:0,class:"row"},Ve={class:"form-check form-check-inline w-100"},Oe=["value","checked"],Pe={class:"form-check-label"},Ue={key:1,class:"row"},je=E(()=>t("div",{class:"col-12"},[t("div",{class:"text-center my-3"}," Ничего не найдено... ")],-1)),Ge=[je],Re={class:"card-footer"},qe={class:"d-flex"},Ne={class:"form-check mb-0"},Ae=["checked"],De=E(()=>t("span",{class:"form-check-label"},"Показать только запущенные скрипты",-1)),We={class:"filter_buttons ms-auto"},Ee={__name:"MyFilter",setup(e){const o=j(),i=q(),c=y(""),d=dt(),p=y();O(()=>{i.filterCollapse=p.value,i.initFilterCollapse()});const u=N(()=>[...o.subsystemsFilter].filter(v=>v.toLowerCase().includes(c.value.toLowerCase()))),h=()=>{o.displayRunningOnly=void 0,o.selectedFilter=[],d.push({query:void 0}),c.value="",o.scenarios=[],o.fetchScenarios()},m=()=>{d.push({query:{projects:o.selectedFilter.length>0?o.selectedFilter.join(","):void 0,displayRunningOnly:o.displayRunningOnly===!0?!0:void 0}}),o.scenarios=[],o.fetchScenarios()};return(v,a)=>(s(),n("div",{class:"collapse",id:"collapseFilter",ref_key:"filterCollapse",ref:p},[t("div",$e,[t("div",we,[Ce,t("div",xe,[t("div",Ie,[t("span",Se,[k(l($t),{class:"icon"})]),t("input",{class:"form-control",placeholder:"Поиск...",value:c.value,onInput:a[0]||(a[0]=r=>c.value=r.target.value)},null,40,Me)])])]),t("div",Fe,[t("div",Be,[t("form",Le,[u.value.length>0?(s(),n("div",Te,[(s(!0),n(_,null,x(u.value,r=>(s(),n("div",{class:"col-3",key:r},[t("label",Ve,[F(t("input",{class:"form-check-input",type:"checkbox",value:r,checked:l(o).selectedFilter.includes(r),"onUpdate:modelValue":a[1]||(a[1]=C=>l(o).selectedFilter=C),onChange:a[2]||(a[2]=(...C)=>v.handleChange&&v.handleChange(...C))},null,40,Oe),[[rt,l(o).selectedFilter]]),t("span",Pe,g(r),1)])]))),128))])):(s(),n("div",Ue,Ge))])])]),t("div",Re,[t("div",qe,[t("label",Ne,[t("input",{class:"form-check-input",type:"checkbox",checked:l(o).displayRunningOnly,onClick:a[3]||(a[3]=r=>l(o).displayRunningOnly=r.target.checked)},null,8,Ae),De]),t("div",We,[l(o).selectedFilter.length||l(o).displayRunningOnly||c.value.length?(s(),n("button",{key:0,class:"btn btn-info me-2 btn-sm btn-icon ps-2 pe-2",onClick:h},[k(l(wt),{class:"icon"})])):M("",!0),t("button",{class:"btn btn-success btn-sm ps-2 pe-2",onClick:m}," Применить фильтры ")])])])])],512))}},ze=U(Ee,[["__scopeId","data-v-1ceadcb3"]]),$=e=>(G("data-v-cce8ed95"),e=e(),R(),e),He={class:"card mb-3"},Ke={class:"table-responsive"},Xe={class:"table table-vcenter card-table"},Je=$(()=>t("th",{class:"text-center"},"Генератор",-1)),Qe=$(()=>t("th",{class:"text-center"},"Статус",-1)),Ye=$(()=>t("th",{class:"text-center"},"CPU",-1)),Ze=$(()=>t("th",{class:"text-center"},"MEM",-1)),ts=$(()=>t("th",{class:"text-center"},"Disk",-1)),es=$(()=>t("th",{class:"text-center"},"Loadavg",-1)),ss={class:"text-center"},os={key:0},ns={class:"text-center"},as={class:"text-center"},ls={key:0},cs=$(()=>t("span",{class:"status status-green"}," OK ",-1)),is=[cs],ds={key:1},rs={class:"text-center"},us=$(()=>t("span",{class:"status status-red"}," Недоступен ",-1)),hs=$(()=>t("br",null,null,-1)),vs=["onClick"],ps={class:"text-center"},_s={class:"text-center"},ms={class:"text-center"},ys={class:"text-center"},bs={class:"text-center"},gs=["onClick"],ks={key:1},fs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-6"},"/")],-1)),$s=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-3"},[t("span",{class:"status placeholder col-9"},"/")])],-1)),ws=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),Cs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),xs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),Is=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-8"},"—")],-1)),Ss=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-6"},[t("button",{class:"btn btn-info ps-3 pe-3 placeholder"}," git pull ")])],-1)),Ms=[fs,$s,ws,Cs,xs,Is,Ss],Fs={__name:"MyGenerators",setup(e){const o=ut(),i=q(),c=y(),d=y(null);O(()=>{i.generatorsCollapse=c.value,i.initGeneratorsCollapse()});const p=async m=>{d.value=m,await o.checkConnection(m),d.value=null},u=async m=>{d.value=m,await o.doGitPull(m),d.value=null},h=async()=>{o.generators=[],setTimeout(()=>{o.fetchGenerators()},400)};return(m,v)=>(s(),n("div",{class:"collapse position-relative",id:"collapseGenerators",ref_key:"generatorsCollapse",ref:c},[t("div",He,[t("div",Ke,[t("table",Xe,[t("thead",null,[t("tr",null,[Je,Qe,Ye,Ze,ts,es,t("th",ss,[w(" DoGitPull "),t("span",{class:"generator_reset cursor-pointer","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Обновить список генераторов",onClick:h},[k(l(ft),{class:"icon"})])])])]),l(o).generators.length?(s(),n("tbody",os,[(s(!0),n(_,null,x(l(o).generators,a=>(s(),n("tr",{key:a.id},[t("td",ns,g(a.ip),1),t("td",as,[a.available?(s(),n("span",ls,is)):(s(),n("span",ds,[t("td",rs,[us,hs,t("button",{class:B([{"btn-loading":a.generatorId==d.value},"btn btn-danger btn-sm ps-3 pe-3 mt-2"]),onClick:r=>p(a.generatorId)}," Подробнее ",10,vs)])]))]),t("td",ps,[a.available?(s(),n(_,{key:0},[w(g(a.cpu)+"% ",1)],64)):(s(),S(l(P),{key:1,class:"icon icon-tabler"}))]),t("td",_s,[a.available?(s(),n(_,{key:0},[w(g(a.mem)+"% ",1)],64)):(s(),S(l(P),{key:1,class:"icon icon-tabler"}))]),t("td",ms,[a.available?(s(),n(_,{key:0},[w(g(a.disk)+"% ",1)],64)):(s(),S(l(P),{key:1,class:"icon icon-tabler"}))]),t("td",ys,[a.available?(s(),n(_,{key:0},[w(g(a.loadavg),1)],64)):(s(),S(l(P),{key:1,class:"icon icon-tabler"}))]),t("td",bs,[a.available?(s(),n("button",{key:0,class:B([{"btn-loading":a.generatorId==d.value},"btn btn-info ps-3 pe-3"]),onClick:r=>u(a.generatorId)},[k(l(bt),{class:"icon icon-tabler icon-tabler-git-pull-request"}),w(" git pull ")],10,gs)):(s(),S(l(P),{key:1,class:"icon icon-tabler"}))])]))),128))])):(s(),n("tbody",ks,[(s(!0),n(_,null,x(l(o).generatorsCount,a=>(s(),n("tr",{class:"placeholder-glow",key:a},Ms))),128))]))])])])],512))}},Bs=U(Fs,[["__scopeId","data-v-cce8ed95"]]),z=e=>(G("data-v-33a974fb"),e=e(),R(),e),Ls={class:"card mb-3"},Ts={class:"table-responsive"},Vs={class:"table table-vcenter card-table"},Os=z(()=>t("thead",null,[t("tr",null,[t("th",null,"Сертификат"),t("th")])],-1)),Ps={key:0},Us={key:0,class:"text-success"},js={key:1,class:"text-warning"},Gs=["onClick"],Rs={key:1},qs={class:"placeholder-glow"},Ns=z(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-6"},"/")],-1)),As=z(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),Ds=[Ns,As],Ws={__name:"MyCerts",setup(e){const o=A(),i=q(),c=y();return y(null),O(()=>{i.certsCollapse=c.value,i.initCertsCollapse()}),(d,p)=>(s(),n("div",{class:"collapse position-relative",id:"collapseCerts",ref_key:"certsCollapse",ref:c},[t("div",Ls,[t("div",Ts,[t("table",Vs,[Os,l(o).certs.length?(s(),n("tbody",Ps,[(s(!0),n(_,null,x(l(o).certs,u=>(s(),n("tr",{key:u.id},[t("td",null,g(u.path)+g(u.name),1),t("td",null,[u.passwordSet?(s(),n("span",Us,[k(l(gt)),w(" Пароль сохранён ")])):(s(),n("span",js,[k(l(kt)),w(" Пароль не задан ")])),t("button",{class:"btn btn-sm w-100 set__password d-none",onClick:h=>l(i).showPasswordModal(u.id)},[u.passwordSet?(s(),n(_,{key:0},[w(" Изменить пароль ")],64)):(s(),n(_,{key:1},[w(" Задать пароль ")],64))],8,Gs)])]))),128))])):(s(),n("tbody",Rs,[(s(),n(_,null,x([1,2,3,4],u=>t("tr",qs,Ds)),64))]))])])])],512))}},Es=U(Ws,[["__scopeId","data-v-33a974fb"]]),zs={class:"modal-dialog modal-dialog-centered",role:"document"},Hs={class:"modal-content"},Ks=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Xs={class:"modal-body text-center py-4"},Js=["innerHTML"],Qs={class:"modal-dialog modal-dialog-centered",role:"document"},Ys={class:"modal-content"},Zs=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Изменить пароль от сертификата"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),to={class:"modal-body"},eo={class:"modal-footer"},so={__name:"modal",setup(e){const o=q(),i=A(),c=y(null),d=y(null),p=y(null),u=async()=>{o.isLoadingButton=!0,await i.setCertPassword(o.certId,p.value),p.value="",o.isLoadingButton=!1};return O(()=>{o.initModal("alert",c.value),o.initModal("password",d.value)}),(h,m)=>(s(),n(_,null,[t("div",{class:"modal modal-blur fade",tabindex:"-1",role:"dialog","aria-hidden":"true",ref_key:"modal",ref:c},[t("div",zs,[t("div",Hs,[Ks,t("div",{class:B(["modal-status",{"bg-danger":l(o).type=="danger","bg-warning":l(o).type=="warning","bg-success":l(o).type=="success"}])},null,2),t("div",Xs,[l(o).type=="danger"?(s(),S(l(K),{key:0,class:"icon mb-2 text-danger icon-lg"})):M("",!0),l(o).type=="warning"?(s(),S(l(K),{key:1,class:"icon mb-2 text-warning icon-lg"})):M("",!0),l(o).type=="success"?(s(),S(l(_t),{key:2,class:"icon mb-2 text-success icon-lg"})):M("",!0),t("div",{class:"text-muted response-body",innerHTML:l(o).content},null,8,Js)])])])],512),t("div",{class:"modal modal-blur fade",tabindex:"-1",role:"dialog","aria-hidden":"true",ref_key:"modalSetPassword",ref:d},[t("div",Qs,[t("div",Ys,[Zs,t("div",to,[F(t("input",{class:"form-control",placeholder:"Введите пароль от сертификата","onUpdate:modelValue":m[0]||(m[0]=v=>p.value=v)},null,512),[[W,p.value]])]),t("div",eo,[t("button",{type:"button",class:B(["btn btn-success w-100",{"btn-loading":l(o).isLoadingButton}]),onClick:u}," Сохранить ",2)])])])],512)],64))}},L=e=>(G("data-v-43545f03"),e=e(),R(),e),oo={class:"page-wrapper"},no={class:"page-body"},ao={class:"container-xl"},lo={class:"row row-cards"},co={class:"col-lg-12"},io={class:"card"},ro={class:"table-responsive"},uo={class:"table table-vcenter card-table"},ho=L(()=>t("thead",null,[t("tr",null,[t("th",null,"Project"),t("th",null,"Scenario"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Uptime"),t("th")])],-1)),vo={key:0},po={key:1},_o={class:"placeholder-glow"},mo=L(()=>t("td",{class:"word_break"},[t("div",{class:"placeholder col-12"}," / ")],-1)),yo=L(()=>t("td",{class:"word_break"},[t("div",{class:"placeholder col-10"}," / ")],-1)),bo=L(()=>t("td",{class:"text-center"},[t("span",{class:"status placeholder col-9"},"Online")],-1)),go=L(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-9"}," — ")],-1)),ko={key:0},fo={class:"row"},$o=L(()=>t("div",{class:"col"},[t("button",{class:"btn btn-outline-danger btn-sm px-3 disabled laceholder"}," Stop ")],-1)),wo={class:"col-auto"},Co={class:"btn btn-outline-info btn-sm px-2 disabled placeholder"},xo=L(()=>t("span",null,[t("small",{class:"text-muted d-block mt-2 placeholder col-2"},"000.000.000"),t("small",{class:"text-muted d-block mt-2 placeholder col-12"},"-")],-1)),Io={key:1},So=pt('<div class="row" data-v-43545f03><div class="col-5" data-v-43545f03><select class="form-select placeholder w-100 pe-none" readonly data-v-43545f03></select></div><div class="col-auto" data-v-43545f03><button class="btn btn-outline-success me-2 disabled placeholder" data-v-43545f03> Start </button><button class="btn btn-outline-warning disabled placeholder" data-v-43545f03> Force start </button></div></div><input type="text" class="form-control mt-2 w-100 fs-5 placeholder" data-v-43545f03>',2),Mo=[So],Fo={__name:"MainPage",setup(e){const o=ht(),i=j(),c=A(),d=q();return O(async()=>{await i.fetchFilter(),await c.fetchCerts(),document.body.setAttribute("data-bs-theme",d.theme),new vt(document.body,{selector:"[data-bs-toggle='tooltip']"}),o.query.projects!==void 0&&o.query.projects.split(",").forEach(u=>{i.subsystemsFilter.includes(u)&&i.selectedFilter.push(u)}),o.query.displayRunningOnly!==void 0&&o.query.displayRunningOnly=="true"&&(i.displayRunningOnly=!0),await i.fetchScenarios()}),(p,u)=>(s(),n(_,null,[t("div",oo,[t("div",no,[t("div",ao,[t("div",lo,[t("div",co,[k(ze),k(Bs),k(Es),t("div",io,[t("div",ro,[t("table",uo,[ho,l(i).scenarios.length>0?(s(),n("tbody",vo,[(s(!0),n(_,null,x(l(i).scenarios,h=>(s(),S(fe,{key:h.id,scenario:h},null,8,["scenario"]))),128))])):(s(),n("tbody",po,[(s(),n(_,null,x([!0,!0,!0,!0,!0,!1,!1,!1],h=>t("tr",_o,[mo,yo,bo,go,h?(s(),n("td",ko,[t("div",fo,[$o,t("div",wo,[t("button",Co,[k(l(tt),{class:"icon icon-tabler"}),w(" Instance ")])])]),xo])):(s(),n("td",Io,Mo))])),64))]))])])])])])])])]),k(so)],64))}},Lo=U(Fo,[["__scopeId","data-v-43545f03"]]);export{Lo as default};
