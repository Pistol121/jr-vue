import{c as I,d as nt,r as b,a as N,h as z,m as at,T as lt,u as l,o as P,b as ct,t as k,_ as U,e as A,f as j,g as s,i as n,j as t,w as B,v as D,F as _,k as x,n as M,l as y,I as Q,p as Y,q as W,s as G,x as R,y as S,z as w,A as it,B as F,C as q,D as dt,E as rt,G as ut,H as ht,J as vt,K as pt}from"./index-k9jXrR4t.js";var H=I("alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]),_t=I("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),bt=I("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),mt=I("chevron-up","IconChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),yt=I("git-pull-request","IconGitPullRequest",[["path",{d:"M6 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M6 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M18 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M6 8l0 8",key:"svg-3"}],["path",{d:"M11 6h5a2 2 0 0 1 2 2v8",key:"svg-4"}],["path",{d:"M14 9l-3 -3l3 -3",key:"svg-5"}]]),O=I("line-dashed","IconLineDashed",[["path",{d:"M5 12h2",key:"svg-0"}],["path",{d:"M17 12h2",key:"svg-1"}],["path",{d:"M11 12h2",key:"svg-2"}]]),gt=I("lock-check","IconLockCheck",[["path",{d:"M11.5 21h-4.5a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v.5",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-3"}]]),kt=I("lock-minus","IconLockMinus",[["path",{d:"M12.5 21h-5.5a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}],["path",{d:"M16 19h6",key:"svg-3"}]]),Z=I("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),tt=I("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),ft=I("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]),$t=I("search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]),wt=I("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function K(e){return{height:e.style.height,width:e.style.width,position:e.style.position,visibility:e.style.visibility,overflow:e.style.overflow,paddingTop:e.style.paddingTop,paddingBottom:e.style.paddingBottom,borderTopWidth:e.style.borderTopWidth,borderBottomWidth:e.style.borderBottomWidth,marginTop:e.style.marginTop,marginBottom:e.style.marginBottom}}function Ct(e,o,i){const c=l(e),{width:d}=getComputedStyle(o);o.style.width=d,o.style.position="absolute",o.style.visibility="hidden",o.style.height="";const{height:p}=getComputedStyle(o);return o.style.width=i.width,o.style.position=i.position,o.style.visibility=i.visibility,o.style.height=c,o.style.overflow="hidden",i.height&&i.height!=c?i.height:p}function X(e,o,i,c,d){const p=e.animate(c,d);e.style.height=o.height,p.onfinish=()=>{e.style.overflow=o.overflow,i()}}function J(e,o,i,c){const d=l(o);return[{height:d,opacity:e.opacityClosed,paddingTop:d,paddingBottom:d,borderTopWidth:d,borderBottomWidth:d,marginTop:d,marginBottom:d},{height:i,opacity:e.opacityOpen,paddingTop:c.paddingTop||0,paddingBottom:c.paddingBottom||0,borderTopWidth:c.borderTopWidth||0,borderBottomWidth:c.borderBottomWidth||0,marginTop:c.marginTop||0,marginBottom:c.marginBottom||0}]}const et=nt({props:{modelValue:{type:Boolean,default:!1},duration:{type:Number,default:500},timingFunction:{type:String,default:"ease-in-out"},timingFunctionEnter:{type:String,default:null},timingFunctionLeave:{type:String,default:null},opacityOpen:{type:Number,default:1},opacityClosed:{type:Number,default:0},tag:{type:String,default:"div"}},emits:["update:modelValue","open-start","open-end","close-start","close-end"],setup(e,{slots:o,attrs:i,emit:c}){const d=b("0px"),p=N(()=>e.timingFunctionEnter||e.timingFunction),r=N(()=>e.timingFunctionLeave||e.timingFunction);function h(v,a){const u=v,C=K(u),T=Ct(d,u,C),V=J(e,d,T,C),f={duration:e.duration,easing:p.value};X(u,C,()=>{a(),c("open-end")},V,f)}function g(v,a){const u=v,C=K(u),{height:T}=getComputedStyle(u);u.style.height=T,u.style.overflow="hidden";const V=J(e,d,T,C).reverse(),f={duration:e.duration,easing:r.value};X(u,C,()=>{a(),c("close-end")},V,f)}return()=>z(lt,{css:!1,onBeforeEnter:()=>c("open-start"),onEnter:h,onBeforeLeave:()=>c("close-start"),onLeave:g},{default:()=>e.modelValue?z(e.tag,at(i,{class:"slide-up-down__container"}),o):null})}}),xt={__name:"MyCountUp",props:{start:{type:Number,required:!0}},setup(e){const o=e,i=b(Date.now()),c=b(null),d=()=>{i.value=i.value+1e3},p=N(()=>{if(o.start==0)return"—";let r=Math.round((i.value-o.start)/1e3),h={days:Math.floor(r/(3600*24)),hours:Math.floor(r%(3600*24)/3600),minutes:Math.floor(r%3600/60),seconds:Math.floor(r%60)};return(h.days>0?`${h.days} д `:"")+(h.hours<10?`0${h.hours}`:`${h.hours}`)+(h.minutes<10?`:0${h.minutes}`:`:${h.minutes}`)+(h.seconds<10?`:0${h.seconds}`:`:${h.seconds}`)});return P(()=>{c.value=setInterval(d,1e3)}),ct(()=>{clearInterval(c.value)}),(r,h)=>k(p.value)}},st=e=>(G("data-v-3dfecaf4"),e=e(),R(),e),It={class:"row"},St={class:"col-auto"},Mt=["value"],Ft={class:"col"},Bt={class:"col-auto"},Lt={key:1,class:"tag border-success-subtle gap-1 px-2 h-100"},Tt={key:1,class:"spinner-border spinner-border-sm"},Vt={class:"col-12"},Pt={class:"form-floating mt-2"},Ot=st(()=>t("option",{value:"",selected:""},"Не выбран",-1)),Ut=["value"],jt=st(()=>t("label",{for:"selectCert"},"Сертификат",-1)),Gt=["list"],Rt=["id"],qt=["value"],Nt={__name:"startScenario",props:{scenario:{type:Object,required:!0,default:()=>{}}},emits:["loading","addInstance"],setup(e,{emit:o}){const i=e,c=o,d=A(),p=j(),r=b(p.selectedGenerator),h=b(""),g=b(""),v=b(!1),a=b(!1),u=async V=>{c("loading",!0);let f=await p.runInstance({entityId:i.scenario.id,generatorId:r.value,args:h.value,certId:g.value},V);c("loading",!1),f===!0&&c("addInstance",!1)},C=async()=>{a.value=!0,await d.unsetCertificate(i.scenario.id),a.value=!1};function T(){return v.value=!v.value,v.value}return(V,f)=>(s(),n("div",It,[t("div",St,[B(t("select",{class:"form-select","onUpdate:modelValue":f[0]||(f[0]=m=>r.value=m)},[(s(!0),n(_,null,x(l(p).generators,m=>(s(),n("option",{key:m.generatorId,value:m.generatorId},k(m.ip),9,Mt))),128))],512),[[D,r.value]])]),t("div",Ft,[t("button",{class:"btn btn-outline-success me-2",onClick:f[1]||(f[1]=m=>u())}," Start "),t("button",{class:"btn btn-outline-warning",onClick:f[2]||(f[2]=m=>u("force"))}," Force start ")]),t("div",Bt,[e.scenario.cert?(s(),n("span",Lt,[y(l(Z),{class:"icon icon-tabler text-success cursor-pointer",size:8,"data-bs-toggle":"tooltip","data-bs-html":"true","data-bs-original-title":`Привязан сертификат<br><strong>${e.scenario.cert}</strong>`},null,8,["data-bs-original-title"]),a.value?(s(),n("span",Tt)):(s(),n("span",{key:0,class:"btn-close cursor-pointer",onClick:C}))])):(s(),n("button",{key:0,class:M(["btn btn-icon",[v.value?"btn-info":"btn-outline-info"]]),onClick:T},[y(l(Q),{class:"icon icon-tabler"})],2))]),t("div",Vt,[y(l(et),{modelValue:v.value,"onUpdate:modelValue":f[4]||(f[4]=m=>v.value=m)},{default:Y(()=>[t("div",Pt,[B(t("select",{class:"form-select",id:"selectCert","aria-label":"Secect .jmx certificate","onUpdate:modelValue":f[3]||(f[3]=m=>g.value=m)},[Ot,(s(!0),n(_,null,x(l(d).certs,m=>(s(),n("option",{key:m.id,value:m.id},k(m.path)+k(m.name),9,Ut))),128))],512),[[D,g.value]]),jt])]),_:1},8,["modelValue"]),B(t("input",{type:"text","onUpdate:modelValue":f[5]||(f[5]=m=>h.value=m),class:"form-control mt-2 w-100 fs-5",spellcheck:"false",list:e.scenario.project+"/"+e.scenario.scenarioName},null,8,Gt),[[W,h.value]]),t("datalist",{id:e.scenario.project+"/"+e.scenario.scenarioName},[(s(!0),n(_,null,x(e.scenario.args,m=>(s(),n("option",{value:m,key:m},null,8,qt))),128))],8,Rt)])]))}},At=U(Nt,[["__scopeId","data-v-3dfecaf4"]]),Dt={class:"row"},Wt={class:"col-auto"},Et=["value"],zt={class:"col-auto"},Ht={class:"col-12"},Kt=["list"],Xt=["id"],Jt=["value"],Qt={__name:"startInstance",props:{scenario:{type:Object,required:!0,default:()=>{}}},emits:["loading"],setup(e,{emit:o}){const i=e,c=o,d=j(),p=b(d.selectedGenerator),r=b(""),h=async g=>{c("loading",!0),await d.runInstance({entityId:i.scenario.id,generatorId:p.value,args:r.value},g),c("loading",!1)};return(g,v)=>(s(),n("div",Dt,[t("div",Wt,[B(t("select",{id:"ipAddress",class:"form-select","onUpdate:modelValue":v[0]||(v[0]=a=>p.value=a)},[(s(!0),n(_,null,x(l(d).generators,a=>(s(),n("option",{key:a.generatorId,value:a.generatorId},k(a.ip),9,Et))),128))],512),[[D,p.value]])]),t("div",zt,[t("button",{class:"btn btn-outline-success me-2",onClick:v[1]||(v[1]=a=>h())}," Start "),t("button",{class:"btn btn-outline-warning",onClick:v[2]||(v[2]=a=>h("force"))}," Force start ")]),t("div",Ht,[B(t("input",{type:"text","onUpdate:modelValue":v[3]||(v[3]=a=>r.value=a),class:"form-control mt-2 w-100 fs-5",spellcheck:"false",list:e.scenario.project+"/"+e.scenario.scenarioName},null,8,Kt),[[W,r.value]]),t("datalist",{id:e.scenario.project+"/"+e.scenario.scenarioName},[(s(!0),n(_,null,x(e.scenario.args,a=>(s(),n("option",{value:a,key:a},null,8,Jt))),128))],8,Xt)])]))}},Yt={class:"word_break"},Zt={class:"word_break"},te={class:"text-center"},ee={key:0,class:"status status-green"},se={key:1,class:"status status-red"},oe={class:"text-center"},ne={class:"row"},ae={class:"col"},le={class:"row row-cols-auto g-2"},ce={class:"col"},ie={key:0,class:"col"},de=["data-bs-original-title"],re={class:"col-auto"},ue={key:0,class:"form-fieldset my-3"},he={key:1},ve={class:"text-muted d-block mt-2"},pe={class:"text-muted d-block mt-2"},_e={key:2,class:"text-center mt-3 mb-1"},be={class:"row"},me={class:"col-auto"},ye=["onClick"],ge={class:"col-auto text-muted mt-auto mb-auto"},ke={class:"text-muted d-block mt-2"},fe={__name:"MyScenario",props:{scenario:Object},setup(e){const o=j(),i=b(!1),c=b(!1),d=b(!1);function p(){return i.value=!i.value,i.value}function r(){return c.value=!c.value,c.value}const h=async v=>{d.value=!0,await o.stopScenarios(v),d.value=!1},g=async(v,a)=>{d.value=!0,await o.stopInstance(v,a),d.value=!1};return(v,a)=>(s(),n("tr",null,[t("td",Yt,k(e.scenario.project),1),t("td",Zt,k(e.scenario.scenarioName),1),t("td",te,[e.scenario.running===!0?(s(),n("span",ee," Online ")):(s(),n("span",se,"Offline"))]),t("td",oe,[e.scenario.running?(s(),S(xt,{key:0,start:e.scenario.instances[0].timestamp},null,8,["start"])):(s(),n(_,{key:1},[w("—")],64))]),t("td",{class:M({loading:d.value})},[B(y(At,{scenario:e.scenario,onLoading:a[0]||(a[0]=u=>d.value=u)},null,8,["scenario"]),[[it,e.scenario.running===!1]]),e.scenario.running===!0?(s(),n(_,{key:0},[t("div",ne,[t("div",ae,[t("div",le,[t("div",ce,[e.scenario.instances.length==1?(s(),n("button",{key:0,class:"btn btn-outline-danger btn-sm px-3",onClick:a[1]||(a[1]=u=>h(e.scenario.id))}," Stop ")):(s(),n("button",{key:1,class:"btn btn-outline-danger btn-sm px-3",onClick:a[2]||(a[2]=u=>h(e.scenario.id))}," Stop all "))]),e.scenario.cert?(s(),n("div",ie,[t("span",{class:"tag border-success-subtle cursor-pointer px-1","data-bs-toggle":"tooltip","data-bs-html":"true","data-bs-original-title":`Запущено с сертификатом<br><strong>${e.scenario.cert}</strong>`},[y(l(Z),{class:"icon icon-tabler text-success",size:7})],8,de)])):F("",!0)])]),t("div",re,[t("button",{class:M(["btn btn-sm px-2",[c.value?"btn-info":"btn-outline-info"]]),onClick:r},[y(l(tt),{class:"icon icon-tabler"}),w(" Instance ")],2)])]),c.value?(s(),n("fieldset",ue,[y(Qt,{scenario:e.scenario,onLoading:a[3]||(a[3]=u=>d.value=u),onAddInstance:a[4]||(a[4]=u=>c.value=!1)},null,8,["scenario"])])):F("",!0),e.scenario.instances.length==1?(s(),n("span",he,[t("small",ve,k(e.scenario.instances[0].ipAddress),1),t("small",pe,k(e.scenario.instances[0].args),1)])):(s(),n("div",_e,[t("div",{class:"link-secondary cursor-pointer",onClick:p},[i.value&&e.scenario.instances.length>1?(s(),n(_,{key:0},[w(" Hide instances "),y(l(mt),{class:"icon icon-tabler"})],64)):(s(),n(_,{key:1},[w(" Show "+k(e.scenario.instances.length)+" instances ",1),y(l(bt),{class:"icon icon-tabler"})],64))])])),e.scenario.instances.length>1?(s(),S(l(et),{key:3,modelValue:i.value,"onUpdate:modelValue":a[5]||(a[5]=u=>i.value=u)},{default:Y(()=>[(s(!0),n(_,null,x(e.scenario.instances,u=>(s(),n("div",{key:u.id,class:"instance my-3"},[t("div",be,[t("div",me,[t("button",{class:"btn btn-outline-danger btn-sm px-3",onClick:C=>g(e.scenario.id,u.id)}," Stop ",8,ye)]),t("div",ge,[t("small",null,k(u.ipAddress),1)])]),t("small",ke,k(u.args),1)]))),128))]),_:1},8,["modelValue"])):F("",!0)],64)):F("",!0)],2)]))}},E=e=>(G("data-v-329bc699"),e=e(),R(),e),$e={class:"card mb-3"},we={class:"card-header"},Ce=E(()=>t("h5",{class:"card-title"},"Выбрать проект(ы)",-1)),xe={class:"card-actions"},Ie={class:"input-icon"},Se={class:"input-icon-addon"},Me=["value"],Fe={class:"card-body"},Be={class:"ps-1 pt-1",id:"scenarios"},Le={id:"filterForm"},Te={key:0,class:"row"},Ve={class:"form-check form-check-inline w-100"},Pe=["value","checked"],Oe={class:"form-check-label"},Ue={key:1,class:"row"},je=E(()=>t("div",{class:"col-12"},[t("div",{class:"text-center my-3"}," Ничего не найдено... ")],-1)),Ge=[je],Re={class:"card-footer"},qe={class:"d-flex"},Ne={class:"form-check mb-0"},Ae=["checked"],De=E(()=>t("span",{class:"form-check-label"},"Показать только запущенные скрипты",-1)),We={class:"filter_buttons ms-auto"},Ee={__name:"MyFilter",setup(e){const o=j(),i=q(),c=b(""),d=dt(),p=b();P(()=>{i.filterCollapse=p.value,i.initFilterCollapse()});const r=N(()=>[...o.subsystemsFilter].filter(v=>v.toLowerCase().includes(c.value.toLowerCase()))),h=()=>{o.displayRunningOnly=void 0,o.selectedFilter=[],d.push({query:void 0}),c.value="",o.scenarios=[],o.fetchScenarios()},g=()=>{d.push({query:{projects:o.selectedFilter.length>0?o.selectedFilter.join(","):void 0,displayRunningOnly:o.displayRunningOnly===!0?!0:void 0}}),o.scenarios=[],o.fetchScenarios()};return(v,a)=>(s(),n("div",{class:"collapse",id:"collapseFilter",ref_key:"filterCollapse",ref:p},[t("div",$e,[t("div",we,[Ce,t("div",xe,[t("div",Ie,[t("span",Se,[y(l($t),{class:"icon"})]),t("input",{class:"form-control",placeholder:"Поиск...",value:c.value,onInput:a[0]||(a[0]=u=>c.value=u.target.value)},null,40,Me)])])]),t("div",Fe,[t("div",Be,[t("form",Le,[r.value.length>0?(s(),n("div",Te,[(s(!0),n(_,null,x(r.value,u=>(s(),n("div",{class:"col-3",key:u},[t("label",Ve,[B(t("input",{class:"form-check-input",type:"checkbox",value:u,checked:l(o).selectedFilter.includes(u),"onUpdate:modelValue":a[1]||(a[1]=C=>l(o).selectedFilter=C),onChange:a[2]||(a[2]=(...C)=>v.handleChange&&v.handleChange(...C))},null,40,Pe),[[rt,l(o).selectedFilter]]),t("span",Oe,k(u),1)])]))),128))])):(s(),n("div",Ue,Ge))])])]),t("div",Re,[t("div",qe,[t("label",Ne,[t("input",{class:"form-check-input",type:"checkbox",checked:l(o).displayRunningOnly,onClick:a[3]||(a[3]=u=>l(o).displayRunningOnly=u.target.checked)},null,8,Ae),De]),t("div",We,[l(o).selectedFilter.length||l(o).displayRunningOnly||c.value.length?(s(),n("button",{key:0,class:"btn btn-info me-2 btn-sm btn-icon ps-2 pe-2",onClick:h},[y(l(wt),{class:"icon"})])):F("",!0),t("button",{class:"btn btn-success btn-sm ps-2 pe-2",onClick:g}," Применить фильтры ")])])])])],512))}},ze=U(Ee,[["__scopeId","data-v-329bc699"]]),$=e=>(G("data-v-e22467ee"),e=e(),R(),e),He={class:"card mb-3"},Ke={class:"table-responsive"},Xe={class:"table table-vcenter card-table"},Je=$(()=>t("th",{class:"text-center"},"Генератор",-1)),Qe=$(()=>t("th",{class:"text-center"},"Статус",-1)),Ye=$(()=>t("th",{class:"text-center"},"CPU",-1)),Ze=$(()=>t("th",{class:"text-center"},"MEM",-1)),ts=$(()=>t("th",{class:"text-center"},"Disk",-1)),es=$(()=>t("th",{class:"text-center"},"Loadavg",-1)),ss={class:"text-center"},os={key:0},ns={class:"text-center"},as={class:"text-center"},ls={key:0},cs=$(()=>t("span",{class:"status status-green"}," OK ",-1)),is=[cs],ds={key:1},rs={class:"text-center"},us=$(()=>t("span",{class:"status status-red"}," Недоступен ",-1)),hs=$(()=>t("br",null,null,-1)),vs=["onClick"],ps={class:"text-center"},_s={class:"text-center"},bs={class:"text-center"},ms={class:"text-center"},ys={class:"text-center"},gs=["onClick"],ks={key:1},fs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-6"},"/")],-1)),$s=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-3"},[t("span",{class:"status placeholder col-9"},"/")])],-1)),ws=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),Cs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),xs=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-5"},"—")],-1)),Is=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-8"},"—")],-1)),Ss=$(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-6"},[t("button",{class:"btn btn-info ps-3 pe-3 placeholder"}," git pull ")])],-1)),Ms=[fs,$s,ws,Cs,xs,Is,Ss],Fs={__name:"MyGenerators",setup(e){const o=ut(),i=q(),c=b(),d=b(null);P(()=>{i.generatorsCollapse=c.value,i.initGeneratorsCollapse()});const p=async g=>{d.value=g,await o.checkConnection(g),d.value=null},r=async g=>{d.value=g,await o.doGitPull(g),d.value=null},h=async()=>{o.generators=[],setTimeout(()=>{o.fetchGenerators()},400)};return(g,v)=>(s(),n("div",{class:"collapse position-relative",id:"collapseGenerators",ref_key:"generatorsCollapse",ref:c},[t("div",He,[t("div",Ke,[t("table",Xe,[t("thead",null,[t("tr",null,[Je,Qe,Ye,Ze,ts,es,t("th",ss,[w(" DoGitPull "),t("span",{class:"generator_reset cursor-pointer","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"Обновить список генераторов",onClick:h},[y(l(ft),{class:"icon"})])])])]),l(o).generators.length?(s(),n("tbody",os,[(s(!0),n(_,null,x(l(o).generators,a=>(s(),n("tr",{key:a.id},[t("td",ns,k(a.ip),1),t("td",as,[a.available?(s(),n("span",ls,is)):(s(),n("span",ds,[t("td",rs,[us,hs,t("button",{class:M([{"btn-loading":a.generatorId==d.value},"btn btn-danger btn-sm ps-3 pe-3 mt-2"]),onClick:u=>p(a.generatorId)}," Подробнее ",10,vs)])]))]),t("td",ps,[a.available?(s(),n(_,{key:0},[w(k(a.cpu)+"% ",1)],64)):(s(),S(l(O),{key:1,class:"icon icon-tabler"}))]),t("td",_s,[a.available?(s(),n(_,{key:0},[w(k(a.mem)+"% ",1)],64)):(s(),S(l(O),{key:1,class:"icon icon-tabler"}))]),t("td",bs,[a.available?(s(),n(_,{key:0},[w(k(a.disk)+"% ",1)],64)):(s(),S(l(O),{key:1,class:"icon icon-tabler"}))]),t("td",ms,[a.available?(s(),n(_,{key:0},[w(k(a.loadavg),1)],64)):(s(),S(l(O),{key:1,class:"icon icon-tabler"}))]),t("td",ys,[a.available?(s(),n("button",{key:0,class:M([{"btn-loading":a.generatorId==d.value},"btn btn-info ps-3 pe-3"]),onClick:u=>r(a.generatorId)},[y(l(yt),{class:"icon icon-tabler icon-tabler-git-pull-request"}),w(" git pull ")],10,gs)):(s(),S(l(O),{key:1,class:"icon icon-tabler"}))])]))),128))])):(s(),n("tbody",ks,[(s(!0),n(_,null,x(l(o).generatorsCount,a=>(s(),n("tr",{class:"placeholder-glow",key:a},Ms))),128))]))])])])],512))}},Bs=U(Fs,[["__scopeId","data-v-e22467ee"]]),ot=e=>(G("data-v-a5ee1b31"),e=e(),R(),e),Ls={class:"card mb-3"},Ts={class:"table-responsive"},Vs={class:"table table-vcenter card-table"},Ps=ot(()=>t("thead",null,[t("tr",null,[t("th",null,"Сертификат"),t("th")])],-1)),Os={key:0},Us={key:0,class:"text-success"},js={key:1,class:"text-warning"},Gs=["onClick"],Rs={key:1},qs={class:"placeholder-glow"},Ns=ot(()=>t("td",{class:"text-end"},[t("div",{class:"placeholder col-12"},"—")],-1)),As={__name:"MyCerts",setup(e){const o=A(),i=q(),c=b();return b(null),P(()=>{i.certsCollapse=c.value,i.initCertsCollapse()}),(d,p)=>(s(),n("div",{class:"collapse position-relative",id:"collapseCerts",ref_key:"certsCollapse",ref:c},[t("div",Ls,[t("div",Ts,[t("table",Vs,[Ps,l(o).certs.length?(s(),n("tbody",Os,[(s(!0),n(_,null,x(l(o).certs,r=>(s(),n("tr",{key:r.id},[t("td",null,k(r.path)+k(r.name),1),t("td",null,[r.passwordSet?(s(),n("span",Us,[y(l(gt)),w(" Пароль сохранён ")])):(s(),n("span",js,[y(l(kt)),w(" Пароль не задан ")])),t("button",{class:"btn btn-sm w-100 set__password d-none",onClick:h=>l(i).showPasswordModal(r.id)},[r.passwordSet?(s(),n(_,{key:0},[w(" Изменить пароль ")],64)):(s(),n(_,{key:1},[w(" Задать пароль ")],64))],8,Gs)])]))),128))])):(s(),n("tbody",Rs,[(s(),n(_,null,x([1,2,3,4],r=>t("tr",qs,[t("td",null,[t("div",{class:M(["placeholder",`col-${l(i).rand(2,5)}`])}," / ",2)]),Ns])),64))]))])])])],512))}},Ds=U(As,[["__scopeId","data-v-a5ee1b31"]]),Ws={class:"modal-dialog modal-dialog-centered",role:"document"},Es={class:"modal-content"},zs=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Hs={class:"modal-body text-center py-4"},Ks=["innerHTML"],Xs={class:"modal-dialog modal-dialog-centered",role:"document"},Js={class:"modal-content"},Qs=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Изменить пароль от сертификата"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ys={class:"modal-body"},Zs={class:"modal-footer"},to={__name:"modal",setup(e){const o=q(),i=A(),c=b(null),d=b(null),p=b(""),r=b(!0),h=async()=>{if(console.log(p.value),p.value===null||p.value==""){r.value=!1;return}o.isLoadingButton=!0,await i.setCertPassword(o.certId,p.value),p.value="",o.isLoadingButton=!1,r.value=!0};return P(()=>{o.initModal("alert",c.value),o.initModal("password",d.value)}),(g,v)=>(s(),n(_,null,[t("div",{class:"modal modal-blur fade",tabindex:"-1",role:"dialog","aria-hidden":"true",ref_key:"modal",ref:c},[t("div",Ws,[t("div",Es,[zs,t("div",{class:M(["modal-status",{"bg-danger":l(o).type=="danger","bg-warning":l(o).type=="warning","bg-success":l(o).type=="success"}])},null,2),t("div",Hs,[l(o).type=="danger"?(s(),S(l(H),{key:0,class:"icon mb-2 text-danger icon-lg"})):F("",!0),l(o).type=="warning"?(s(),S(l(H),{key:1,class:"icon mb-2 text-warning icon-lg"})):F("",!0),l(o).type=="success"?(s(),S(l(_t),{key:2,class:"icon mb-2 text-success icon-lg"})):F("",!0),t("div",{class:"text-muted response-body",innerHTML:l(o).content},null,8,Ks)])])])],512),t("div",{class:"modal modal-blur fade",tabindex:"-1",role:"dialog","aria-hidden":"true",ref_key:"modalSetPassword",ref:d},[t("div",Xs,[t("div",Js,[Qs,t("div",Ys,[B(t("input",{class:M(["form-control",{"is-invalid":!r.value}]),placeholder:"Введите пароль от сертификата",onKeyup:v[0]||(v[0]=a=>r.value=!0),"onUpdate:modelValue":v[1]||(v[1]=a=>p.value=a)},null,34),[[W,p.value,void 0,{trim:!0}]])]),t("div",Zs,[t("button",{type:"button",class:M(["btn btn-success w-100",{"btn-loading":l(o).isLoadingButton}]),onClick:h}," Сохранить ",2)])])])],512)],64))}},L=e=>(G("data-v-9a9b74c7"),e=e(),R(),e),eo={class:"page-wrapper"},so={class:"page-body"},oo={class:"container-xl"},no={class:"row row-cards"},ao={class:"col-lg-12"},lo={class:"card"},co={class:"table-responsive"},io={class:"table table-vcenter card-table"},ro=L(()=>t("thead",null,[t("tr",null,[t("th",null,"Project"),t("th",null,"Scenario"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Uptime"),t("th")])],-1)),uo={key:0},ho={key:1},vo={class:"placeholder-glow"},po=L(()=>t("td",{class:"word_break"},[t("div",{class:"placeholder col-12"}," / ")],-1)),_o=L(()=>t("td",{class:"word_break"},[t("div",{class:"placeholder col-10"}," / ")],-1)),bo=L(()=>t("td",{class:"text-center"},[t("span",{class:"status placeholder col-9"},"Online")],-1)),mo=L(()=>t("td",{class:"text-center"},[t("div",{class:"placeholder col-9"}," — ")],-1)),yo={key:0},go={class:"row"},ko=L(()=>t("div",{class:"col"},[t("button",{class:"btn btn-outline-danger btn-sm px-3 disabled laceholder"}," Stop ")],-1)),fo={class:"col-auto"},$o={class:"btn btn-outline-info btn-sm px-2 disabled placeholder"},wo=L(()=>t("span",null,[t("small",{class:"text-muted d-block mt-2 placeholder col-2"},"000.000.000"),t("small",{class:"text-muted d-block mt-2 placeholder col-12"},"-")],-1)),Co={key:1},xo={class:"row"},Io=pt('<div class="col-4" data-v-9a9b74c7><select class="form-select placeholder w-100 pe-none" readonly data-v-9a9b74c7></select></div><div class="col" data-v-9a9b74c7><button class="btn btn-outline-success me-2 disabled placeholder" data-v-9a9b74c7> Start </button><button class="btn btn-outline-warning disabled placeholder" data-v-9a9b74c7> Force start </button></div>',2),So={class:"col-auto"},Mo={class:"btn btn-icon btn-outline-info disabled placeholder"},Fo=L(()=>t("input",{type:"text",class:"form-control mt-2 w-100 fs-5 placeholder"},null,-1)),Bo={__name:"MainPage",setup(e){const o=ht(),i=j(),c=A(),d=q();return P(async()=>{await i.fetchFilter(),await c.fetchCerts(),document.body.setAttribute("data-bs-theme",d.theme),new vt(document.body,{selector:"[data-bs-toggle='tooltip']"}),o.query.projects!==void 0&&o.query.projects.split(",").forEach(r=>{i.subsystemsFilter.includes(r)&&i.selectedFilter.push(r)}),o.query.displayRunningOnly!==void 0&&o.query.displayRunningOnly=="true"&&(i.displayRunningOnly=!0),await i.fetchScenarios()}),(p,r)=>(s(),n(_,null,[t("div",eo,[t("div",so,[t("div",oo,[t("div",no,[t("div",ao,[y(ze),y(Bs),y(Ds),t("div",lo,[t("div",co,[t("table",io,[ro,l(i).scenarios.length>0?(s(),n("tbody",uo,[(s(!0),n(_,null,x(l(i).scenarios,h=>(s(),S(fe,{key:h.id,scenario:h},null,8,["scenario"]))),128))])):(s(),n("tbody",ho,[(s(),n(_,null,x([!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1,!1],h=>t("tr",vo,[po,_o,bo,mo,h?(s(),n("td",yo,[t("div",go,[ko,t("div",fo,[t("button",$o,[y(l(tt),{class:"icon icon-tabler"}),w(" Instance ")])])]),wo])):(s(),n("td",Co,[t("div",xo,[Io,t("div",So,[t("button",Mo,[y(l(Q),{class:"icon icon-tabler"})])])]),Fo]))])),64))]))])])])])])])])]),y(to)],64))}},To=U(Bo,[["__scopeId","data-v-9a9b74c7"]]);export{To as default};
